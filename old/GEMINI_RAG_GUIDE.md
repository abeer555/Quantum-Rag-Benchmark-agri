# Enhanced Agricultural RAG with Gemini API

## ğŸš€ Quick Setup

### 1. Install Dependencies

```bash
pip install google-generativeai
# or run the setup script
./setup_gemini_rag.sh
```

### 2. Get Gemini API Key

1. Visit [Google AI Studio](https://makersuite.google.com/app/apikey)
2. Create a new API key
3. Copy the key

### 3. Set Environment Variable

```bash
# Temporary (current session)
export GEMINI_API_KEY='your-api-key-here'

# Permanent (add to ~/.bashrc or ~/.zshrc)
echo 'export GEMINI_API_KEY="your-api-key-here"' >> ~/.bashrc
source ~/.bashrc
```

### 4. Run the Enhanced RAG

```bash
python src/better_rag.py
```

## ğŸ”„ How It Works

The system uses a **three-tier fallback approach**:

1. **ğŸ”® Gemini API (Primary)**: High-quality, contextual answers
2. **ğŸ¤– Local T5 Model (Fallback)**: When Gemini is unavailable
3. **ğŸ“ Extractive Answers (Final Fallback)**: When generation fails

## ğŸ’¬ Example Usage

```
â“ Your question: what is the best time to plant wheat

ğŸ” Processing: 'what is the best time to plant wheat'...
ğŸ“š Found 5 relevant sources
ğŸ”® Generating answer with Gemini API...

--- Generated Answer ---
The best time to plant wheat depends on the variety. Winter wheat should be planted in fall (September-November) to allow it to develop 10-15 cm in height before winter, requiring a cold period for dormancy that's broken by spring warming. Spring wheat is planted in early spring when soil conditions are suitable. The timing ensures optimal growth conditions and survival through seasonal changes. [Generated by Gemini]

ğŸ“– Top Sources:
  1. potassium. An acid and peaty soil is not suitable. Wheat needs some 30 to 38 cm...
  2. freeze. It needs to develop to a height of 10 to 15 cm before the cold intervene...
  3. ## Wheat Wheat is a group of wild and domesticated grasses of the genus Triticum...
```

## ğŸ”§ Configuration Options

### Without Gemini API Key

- System automatically falls back to local T5 model
- Still provides functional RAG capabilities
- No external API calls

### With Gemini API Key

- High-quality, contextual answers
- Better understanding of agricultural concepts
- More comprehensive responses

## ğŸ› ï¸ Troubleshooting

### "GEMINI_API_KEY not found"

```bash
# Check if environment variable is set
echo $GEMINI_API_KEY

# Set it temporarily
export GEMINI_API_KEY='your-key'
```

### "Gemini API not available"

```bash
# Install the package
pip install google-generativeai
```

### Memory Issues

- The system automatically uses CPU-only mode for T5
- Gemini API calls don't use local GPU memory
- Adjust batch_size in indexing if needed

## ğŸ“Š Performance Comparison

| Method     | Quality    | Speed      | Dependencies |
| ---------- | ---------- | ---------- | ------------ |
| Gemini API | â­â­â­â­â­ | â­â­â­     | API Key      |
| Local T5   | â­â­â­     | â­â­â­â­   | CPU only     |
| Extractive | â­â­       | â­â­â­â­â­ | None         |

## ğŸŒŸ Benefits

- **High-Quality Answers**: Gemini provides coherent, contextual responses
- **Robust Fallbacks**: Never fails to provide an answer
- **Cost-Effective**: Only uses API when local models insufficient
- **Easy Setup**: Single environment variable configuration
- **Agricultural Focus**: Specialized prompts for farming questions
